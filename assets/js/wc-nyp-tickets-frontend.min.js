/*!  2.0.0-beta.2 2021-09-17 10:14 */

jQuery(function(a){a(document).on("wc-nyp-initializing",function(t,e){const i=e.$el;let c=i.find(tribe.tickets.block.selectors.submit);c.length||(c=i.find(tribe.tickets.modal.selectors.submit)),c.length&&(e.$add_to_cart=c)}),a(document).on("afterTicketsQuantityChange.tribeTicketsBlock",function(t,e){const i=e.closest(tribe.tickets.block.selectors.item).find(".nyp");i.length&&(e=0<e.val(),i.data("optional_status",e),i.trigger("wc-nyp-update"))}),a(tribe.dialogs.events).on("tribe_dialog_show_ar_modal",function(t,e){const i=a(e),c=i.find(tribe.tickets.modal.selectors.form),o=i.find(tribe.tickets.modal.selectors.cartForm),s=a(document).find(tribe.tickets.block.selectors.form).filter('[data-post-id="'+c.data("postId")+'"]'),r=s.find(tribe.tickets.block.selectors.item),n=tribe.tickets.block.getTicketsBlockProvider(c);r.each(function(){const t=a(this);var e,i=t.data("ticket-id");const c=o.find('[data-ticket-id="'+i+'"]');0!==c.length&&0!==t.length&&c.hasClass("nyp-product")&&(e=t.data("ticket-price"),c.data("ticket-price",e).find(".nyp-input").val(woocommerce_nyp_format_price(e)).attr("type","hidden"),c.find(tribe.tickets.modal.selectors.itemPrice).text(tribe.tickets.utils.numberFormat(e,n)),tribe.tickets.modal.updateItem(i,c,t))}),c.addClass("cart").wc_nyp_form()}),a(tribe.tickets.block.selectors.form).each(function(){const t=a(this);tribe.tickets.block.commerceSelector.woo===tribe.tickets.block.getTicketsBlockProvider(t)&&t.addClass("cart").wc_nyp_form()}),a(document).on("wc-nyp-updated",function(t,e){const i=e.$cart;var c=tribe.tickets.block.getTicketsBlockProvider(i);const o=e.$el.closest(tribe.tickets.block.selectors.item);var s=o.data("ticket-id"),e=e.getPrice();if(o.length){a(tribe.tickets.block.selectors.container).find(tribe.tickets.block.selectors.item).filter('[data-ticket-id="'+s+'"]').data("ticket-price",e),o.data("ticket-price",e),o.find(tribe.tickets.block.selectors.itemPrice).text(tribe.tickets.utils.numberFormat(e,c));const r=o.find(tribe.tickets.block.selectors.itemQuantityInput);r.length&&parseInt(r.val(),10)&&(tribe.tickets.block.updateFormTotals(i),i.is(tribe.tickets.modal.selectors.form)&&tribe.tickets.modal.updateItem(s,o))}}),a(document).on("isValidForm.eventTicketsModal",function(t,e){const i=e.wc_nyp_get_script_object();return!(i&&!i.isValid("submit"))})});